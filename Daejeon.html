<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TourMate - Daejeon</title>
    <link rel="stylesheet" href="css/Style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            padding: 0;
            background-color: #f4f4f4;
        }
        header {
            text-align: center;
            margin-bottom: 20px;
        }
        h1 {
            color: #4CAF50;
        }
        h2 {
            color: #333;
        }
        nav ul {
            list-style-type: none;
            padding: 0;
        }
        nav ul li {
            display: inline;
            margin-right: 10px;
        }
        nav ul li a {
            text-decoration: none;
            color: #333;
        }
        .event {
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        .event-title {
            font-size: 1.5em;
            margin: 0;
            color: #333;
        }
        .event-detail {
            margin: 5px 0;
            color: #555;
        }
        #dateSearchForm {
            text-align: center;
            margin-bottom: 20px;
        }
        #dateSearchForm label {
            margin-right: 10px;
        }
        #map {
            width: 100%;
            height: 400px;
            margin-bottom: 20px;
        }
        #result {
            text-align: center;
            margin-top: 20px;
        }
    </style>
    <script async src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCs9iaIlNoA00AzEyhokHBY_-Ne8vGahnM&callback=initMap"></script>
</head>
<body>

<header>
    <h1>Explore Daejeon</h1>
    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="busan.html">Busan</a></li>
            <li><a href="daegu.html">Daegu</a></li>
            <li><a href="jeju.html">Jeju</a></li>
        </ul>
    </nav>
</header>

<section>
    <h2>Welcome to Daejeon</h2>
    <p>Daejeon is famous for its science parks, museums, and advanced technology industries. Don’t miss the Daejeon O-World theme park and the beautiful Hanbat Arboretum.</p>
    <div id="map"></div>

    <form id="dateSearchForm">
        <label for="startDate">시작일:</label>
        <input type="date" id="startDate" required>
        
        <label for="endDate">종료일:</label>
        <input type="date" id="endDate" required>
        
        <button type="submit">검색</button>
    </form>

    <div id="eventList"></div>
    <div id="result"></div>
</section>

<footer>
    <p>© 2024 TourMate. All Rights Reserved.</p>
</footer>

<script>
    const apiUrl = "https://apis.data.go.kr/6300000/eventDataService/eventDataListJson?serviceKey=Jw2oAidGLR16SOZUB2qUKcDezPYS82ewHT2FBzPdaxCtaxyTCfSj9ZdsqtF0%2Fgylb78DE17RH%2B7Bafp2IIunOg%3D%3D&numOfRows=1000&pageNo=1";
    let events = [];

    fetch(apiUrl)
        .then(response => {
            if (!response.ok) {
                throw new Error("네트워크 응답이 좋지 않습니다.");
            }
            return response.json();
        })
        .then(data => {
            if (data.msgBody) {
                events = data.msgBody;
                displayEvents(events);
            } else {
                console.error("msgBody가 정의되지 않았습니다.");
            }
        })
        .catch(error => {
            console.error("오류 발생:", error);
        });

    function displayEvents(eventsToDisplay) {
        const eventList = document.getElementById("eventList");
        eventList.innerHTML = '';

        if (eventsToDisplay.length === 0) {
            eventList.innerHTML = '<p>검색 결과가 없습니다.</p>';
        } else {
            eventsToDisplay.forEach(event => {
                const eventDiv = document.createElement("div");
                eventDiv.className = "event";

                const title = document.createElement("h2");
                title.className = "event-title";
                title.textContent = event.title;

                const contents = document.createElement("p");
                contents.className = "event-detail";
                contents.innerHTML = event.contents;

                const beginTime = document.createElement("p");
                beginTime.className = "event-detail";
                beginTime.innerHTML = `<strong>시작 시간:</strong> ${event.beginTm}`;

                const endTime = document.createElement("p");
                endTime.className = "event-detail";
                endTime.innerHTML = `<strong>종료 시간:</strong> ${event.endTm}`;

                const place = document.createElement("p");
                place.className = "event-detail";
                place.innerHTML = `<strong>장소:</strong> ${event.placeDetail}`;

                const startDate = document.createElement("p");
                startDate.className = "event-detail";
                startDate.innerHTML = `<strong>시작일:</strong> ${event.beginDt}`;

                const endDate = document.createElement("p");
                endDate.className = "event-detail";
                endDate.innerHTML = `<strong>종료일:</strong> ${event.endDt}`;

                eventDiv.appendChild(title);
                eventDiv.appendChild(contents);
                eventDiv.appendChild(beginTime);
                eventDiv.appendChild(endTime);
                eventDiv.appendChild(place);
                eventDiv.appendChild(startDate);
                eventDiv.appendChild(endDate);

                eventList.appendChild(eventDiv);
            });
        }
    }

    document.getElementById('dateSearchForm').addEventListener('submit', function(event) {
        event.preventDefault();

        const startDate = document.getElementById('startDate').value;
        const endDate = document.getElementById('endDate').value;

        if (new Date(startDate) > new Date(endDate)) {
            document.getElementById('result').innerText = '시작일은 종료일보다 앞서야 합니다.';
            displayEvents(events);
        } else {
            const filteredEvents = events.filter(event => {
                return event.beginDt >= startDate && event.endDt <= endDate;
            });
            displayEvents(filteredEvents);
            document.getElementById('result').innerText = `검색 기간: ${startDate} ~ ${endDate}`;
        }
    });

    function initMap() {
        const daejeon = { lat: 36.3504, lng: 127.3845 };
        const map = new google.maps.Map(document.getElementById('map'), {
            zoom: 12,
            center: daejeon
        });
        const marker = new google.maps.Marker({ position: daejeon, map: map });
    }
</script>
</body>
</html>
